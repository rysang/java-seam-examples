<?xml version="1.0"?>

<mx:Application xmlns:mx="http://www.adobe.com/2006/mxml"
	initialize="init()">
	<mx:Metadata>
		[ResourceBundle("login")]
	</mx:Metadata>

	<mx:HTTPService id="loginRequest" url="/web-part/rest/login"
		method="POST" fault="onFail(event)" result="onSuccess(event)">
		<mx:request>
			<username>{username}</username>
			<password>{password}</password>
		</mx:request>
	</mx:HTTPService>

	<mx:Form id="loginForm" width="400">

		<mx:FormItem
			label="{resourceManager.getString('login','org.flex.test.app.login.username')}">
			<mx:TextInput id="username" width="100%" />
		</mx:FormItem>

		<mx:FormItem
			label="{resourceManager.getString('login','org.flex.test.app.login.password')}">
			<mx:TextInput id="password" width="100%" />
		</mx:FormItem>

		<mx:FormItem
			label="{resourceManager.getString('login','org.flex.test.app.login.language')}"
			direction="vertical">
			<mx:ComboBox id="language" width="75"
				change="languageChangeHandler()">
				<mx:ArrayCollection>
					<mx:String>ro_RO</mx:String>
					<mx:String>en_US</mx:String>
				</mx:ArrayCollection>
			</mx:ComboBox>
		</mx:FormItem>

		<mx:FormItem>
			<mx:HRule width="100%" height="1" />
			<mx:Button id="submit"
				label="{resourceManager.getString('login','org.flex.test.app.login.login')}"
				click="send_data()" />
		</mx:FormItem>

	</mx:Form>


	<mx:EmailValidator id="username_val" source="{username}"
		property="text" required="true" trigger="{submit}" triggerEvent="click" />
	<mx:StringValidator id="password_val" source="{password}"
		property="text" required="true" minLength="8" trigger="{submit}"
		triggerEvent="click" />


	<mx:Script>
        <![CDATA[
        	import mx.controls.Alert;
            import mx.rpc.http.HTTPService;
            import mx.rpc.events.ResultEvent;
            import mx.rpc.events.FaultEvent;
        	
        	private function init(): void {
        	   resourceManager.localeChain = [ language.selectedItem ];
        	}
        	
        	private function onSuccess(event:ResultEvent): void {
        		Alert.show(event.result.toString());
        	}
        	
        	private function languageChangeHandler():void {       
            	resourceManager.localeChain = [ language.selectedItem ];                        
        	}
        	
        
        	private function onFail(event:FaultEvent): void {
                Alert.show(event.fault.toString());
        	}
        
            private function send_data():void {
                loginRequest.send();
            }
        ]]>
	</mx:Script>
</mx:Application>